# Agentic Architecture Components - Copilot Instructions

## Project Overview

This repository contains components for building agentic AI systems for demonstration and learning purposes.

It includes:

- Agent imeplementations in `agents/`
- Tool implementations in `tools/`
- Shared libraries in `src/agentic/`

## Instruction Files

The following instruction files contain specific rules for modifying or creating code in different parts of the repository:

| File                                                    | Applies To                | Description                      |
| ------------------------------------------------------- | ------------------------- | -------------------------------- |
| `.github/instructions/containerization.instructions.md` | `**/Containerfile`        | Containerization best practices  |
| `.github/instructions/github_actions.instructions.md`   | `.github/workflows/*.yml` | GitHub Actions workflow patterns |

## Style Guidelines

### List Style Guidelines

- All items in a list should be consistently structured (either simple phrases or complete sentences).
- When a list contains sentences, each sentence should end with a period.
- When a list contains simple phrases, do not use periods.
- Maintain parallel structure across all items in the same list.

## Key Architectural Patterns

### Dependency Management & Script Execution

- Use `uv` (not `pip` or `poetry`) for Python package management.
- Dependencies defined in `pyproject.toml`, locked in `uv.lock`.
- Scripts should have a shebang line at the top and be executable.
- Always run commands via `uv run <relative-path-to-script>` from the repository root directory.

### Code Organization

- Shared utilities in `src/agentic/` (installable package).
- Each agentic architecture component in `agents/` and `tools/` should be containerized and have its own Containerfile.
- Python dependencies are managed centrally in `pyproject.toml`, and each component's dependencies should be defined in a `requirements.txt` generated by `uv export`.
- Each component should have its own README with usage instructions.

### Logging System (`src/agentic/logging.py`)

- Three logging modes:
  - `colorized_config()` - Simple colored output without timestamps.
  - `fancy_config()` - Full formatting with timestamps and log levels.
  - `silent_config()` - Disables logging output entirely.

## Testing

### Running Tests

- Run all tests: `make test` or `uv run pytest`
- Run tests with a coverage report: `make test-cov`

### Test Directory Structure

Tests live in `tests/` and mirror the `src/` directory structure.
A module at `src/agentic/some_module.py` has its tests at `tests/agentic/test_some_module.py`.

### Writing Tests

- Use `pytest` for all tests.
- Use `pytest-asyncio` for async tests. `asyncio_mode = "auto"` is configured in `pyproject.toml`, so no `@pytest.mark.asyncio` decorator is required.
- Follow functional style: use fixture functions, not test classes (per `python.instructions.md`).
- Include module-level docstrings and docstrings on all test functions.
- Place fixtures used by a single package in a `conftest.py` within that package's test directory. Place project-wide fixtures in `tests/conftest.py`.

## Critical Implementation Details

## Avoid

- Don't use `pip install` - always use `uv sync`.

## Developer Tools

### Makefile

The `Makefile` in the repository root provides common developer (contributor) operations. Use `make help` to see all available targets and their descriptions.

When adding new development tools or changing project structure, update the Makefile accordingly. The Makefile uses a dynamic help system - add new targets with `## Description` comments to automatically include them in the help output.

## Containerization & Deployment

### Container Images

- Use `Containerfile` as the filename for container build definitions.
- Use multi-stage builds when appropriate for smaller production images.
- Base images should use Alpine Linux variants when possible for smaller size (e.g., `python:3.13-alpine`).
- Use `requirements.txt` generated by `uv export` for container dependency management.
- Set working directory to `/app` in containers.
- Make scripts executable with `chmod +x` in Containerfile.
- Use `ENTRYPOINT` for the main command and `CMD` for default arguments.
- Expose appropriate ports (e.g., `EXPOSE 8000` for HTTP services).

### GitHub Actions Workflows

- Place workflows in `.github/workflows/` directory with descriptive names.
- Use `build-<service-name>.yml` naming convention for container build workflows.
- Trigger workflows on:
  - Push to `main` branch with path filters for relevant directories
  - Pull requests to `main` branch with path filters
  - Release events (`types: [published]`)
- Use GitHub Container Registry (`ghcr.io`) for hosting images.
- Follow semantic versioning for image tags:
  - `type=ref,event=branch` for branch builds
  - `type=ref,event=pr` for PR builds
  - `type=semver,pattern={{version}}` for releases
  - `type=semver,pattern={{major}}.{{minor}}` for releases
  - `type=semver,pattern={{major}}` for releases
  - `type=sha,prefix={{branch}}-` for commit-specific tags
  - `type=raw,value=latest,enable={{is_default_branch}}` for latest tag
- Include build attestations for supply chain security.
- Use multi-platform builds (`linux/amd64,linux/arm64`) when possible.
- Enable GitHub Actions caching (`cache-from: type=gha`, `cache-to: type=gha,mode=max`).
- Use proper permissions:
  ```yaml
  permissions:
    contents: read
    packages: write
    id-token: write
    attestations: write
  ```
- Follow patterns established in `.github/workflows/build-tools-mcp-weather-server.yml`.
